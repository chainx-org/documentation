---
title: "2.0 迁移指南"
linkTitle: "Migration"
weight: 20
date: 2020-09-25
description: >
  ChainX 1.0 升级至 2.0 的状态迁移指南
---

ChainX 主网自 2019 年 5 月 25 日主网上线，是波卡生态基于 Substrate 框架的第一条链, 目前已经通过内置比特币轻节点的方式实现了比特币资产跨链，并稳定运行至今。由于 ChainX 上线非常早，其底层框架是基于早期的 Substrate 1.0, 而 [Substrate 2.0](https://www.parity.io/substrate-2-0-is-here/) 已于 2020 年 9 月正式发布，不仅加入了很多新的功能模块，链上治理等功能模块也更加完善并得到充分验证。为了引入链上治理开启 ChainX 社区治理的新篇章，以及支持未来接入波卡平行链生态等，当前基于 Substrate 1.0 的 ChainX (称为 ChainX 1.0) 升级到基于 Substrate 2.0 的 ChainX 2.0 是要完成的一个首要任务。

ChainX 2.0 采用状态导出的方式进行升级，1.0 的最终状态会被导入到 2.0 的 Genesis 并以此启动整个网络, 整个升级过程用户并不需要做任何额外操作, 只需等待网络升级完成即可。针对完成 2.0 整个升级, 各方注意点如下:

### 持币用户

#### 资产迁移

L-BTC 与 SDOT 在 ChainX 1.0 阶段已经废除，2.0 迁移完成后，用户只有 PCX 与 X-BTC 两种资产信息, 这两种资产迁移处理如下:

##### PCX 资产

- 用户现有的 PCX 可用余额将会同步迁移至 2.0。

- 用户在链上 DEX 中的已有订单会被自动撤单，相关资产退回到用户相应的 PCX 可用余额。

- 用户的 Staking 投票金额将会同步迁移至 2.0, 处于赎回锁定中的 PCX 将会自动赎回, 所有投票用户与节点在 2.0 的票龄状态将会由迁移高度结算后的各自最新票龄进行初始化.

##### X-BTC 资产

用户的 X-BTC 可用余额自动迁移至 2.0, 在链上 DEX 订单中已锁定与已申请提现的 X-BTC 将会被自动撤单，相关资产会退回到用户的 X-BTC 可用余额。

### 节点用户

#### 节点链上身份

在 ChainX 1.0 中，Staking 模块保留了节点的 url, about 等身份信息, 当迁移至 2.0 后，节点的这些身份信息将由链上的 Identity 模块接管，2.0 Staking 模块仅自动保留了之前的节点名作为跨链用户的推荐渠道 ID, 其他身份信息当 2.0 启动后，由各节点自行通过 Identity 功能模块进行设置.

#### 节点迁移

ChainX 1.0 共注册了 200+ 节点，其中包含了大量非活跃节点，出于链上数据与节点 RPC 的性能考虑，同时提高节点身份可信度, 部分 1.0 注册的节点将不会被自动迁移至 2.0 网络。规则如下：

- 如果节点奖池金额为 0，那么该节点将不会被自动迁移至 2.0 网络，如果该节点下仍有用户投票，所有投票自动撤销。
- 如果节点奖池金额小于 1 PCX，那么该节点将不会被自动迁移至 2.0 网络，奖池处理如下：
  - 如果节点投票等于节点自抵押，即该节点除了自身外没有其他用户投票，那么尚未领取的奖池余额将会直接打给该节点账户。
  - 如果节点此时仍有其他用户投票，那么剩余的奖池金额将由议会账户代为托管。待 2.0 网络启动后，该节点的投票用户可向议会提出申请赎回相应的托管金额。

其余 1.0 网络中注册的节点将会自动迁移至 2.0 网络。

#### 节点奖池地址变更

节点奖池地址生成方式有所变更 TODO

#### 地址管理

ChainX 1.0 仅支持 ed25519 签名，2.0 将增加 sr25519 支持。TODO

### 信托

#### 充值未认领

由于所有的充值未认领金额很小(大部分小于 0.01 BTC), 为了减少打回 BTC 充值原地址的手续费摩擦，ChainX 1.0 链上所有的充值未认领将会统一交由议会托管，用户可向议会提出申请赎回未认领的金额，议会确认完毕后将按照 DEX 价格将未认领的 BTC 金额自动兑换为 PCX 并打回给用户。

### 交易所

#### 已经接入的交易所

- 交易所需要从 1.0 的 JS SDK 升级至 2.0 JS SDK, 迁移文档，组织迁移等。
- 当 ChainX 2.0 升级日期确定后，会提前通知交易所, 交易所暂停充提现并及时通知用户。

#### 新的交易所对接

ChainX 2.0 推荐采用每个交易所账户生成一个 PCX 地址的方式，而不是 1.0 的 memo 方式。

- 对接文档。
